<!DOCTYPE html>
<html>
    <head>
        <meta property="og:image" content="https://mikehelland.github.io/hubbles-law/img/hubbleslaws_graph.png"/>
        <meta property="og:description" content="A demonstration of Hubble's tension and its resolution."/>
        <meta property="og:title" content="Fixing Hubble's Law"/>
        <meta property="og:url" content="https://mikehelland.github.io/hubbles-law/"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.4.0/styles/default.min.css">
        <style>
            body {
                background-color: #CCCCCC;
                color:black;
            }
            #right {
                position:fixed;
                left:750px;
                top:10px;    
            }
            
            #graph {
                height:600px;
                width: 600px;
            }

            .maintext {
                background-color: white;
                max-width: 700px;
                font-family: Arial, Helvetica, sans-serif;
                padding: 15px;
            }

            .pimg  {
                text-align: center;
            }

            li {
                line-height: 1.5em;
            }
            li code, p code {
                background-color: #EEEEEE;
                padding:2px;
                font-weight: bold;
            }

            #y-axis {
                display: none;
            }

            .model {
                min-height: 74px;
            }

            pre code {
                display:block;
                padding:0.5em;
                background: #f0f0f0;
            }
        </style>

    </head>
<body>

<!-- HELLO!!! Source code for the models at the bottom -->

<div class="maintext">
<h1>Hubble's Law as Photon Velocity</h1>

<h2>Introduction</h2>

<p>One effect of an expanding universe is that delays are introduced in the journey of light from one galaxy to another. 
    To demonstrate, let's model a single photon that passes a series of targets placed 200 million light years apart.
</p>

<p>In a simple universe, the photon will reach the first target in 200 million years, the second target in 400 million light years, and so on. </p>

<div class="model" id="staticModel"></div>

<p>In an expanding universe, the targets move away from the photon's source at <code>v = HD</code> as per Hubble's Law, and thus they take longer and longer to reach.

<div class="model" id="expandingFast"></div>

<p>The same delays can be produced if the photon simply lost speed <code>HD</code>, as per Hubble's Law:</p>

<div class="model" id="redshift1"></div>

<p>(Read more: <a href="modeling_expansion.htm">explanation of the models with source code</a>)</p>

<p>As you can see, the model where the entire universe is in motion produces the same output as a single decelerating photon. 
    The hypothesis is that the velocity <code>v</code> of a photon is a function of the distance <code>D</code> it has traveled:</p>

<p class="pimg"><img src="img/v=c-HD.png"></p>

<p>While I found this interesting, as a physical theory the decelerating photon hypothesis has some immediate fatal flaws:</p>

<ul>
    <li>An object in motion remains in motion at a constant speed</li>
    <li>Light travels at c in a vacuum</li>
    <li>Energy has to be conserved</li>
    <li>Redshifts indicate an expanding universe</li>
    <li>The CMB indicates a hot past</li>
    <li>The farthest galaxies are younger than nearby galaxies, indicating a beginning of time</li>
    <li>The Tolman surface brightness test indicates an expanding universe</li> 
    <li>This is the Tired Light Theory, which is discredited</li>
    <li>We don't observe slow light</li>
</ul>

<p>More than a decade has passed since first considering the decelerating photon hypothesis, and much has happened in cosmology:</p>

<ul>
    <li>Measurements of Hubble's constant don't match measurements of the CMB<sup>[1][2][3]</sup></li>
    <li>WMAP and Planck show anomalies in the CMB<sup>[4][5]</sup>:</li>
    <ul>
        <li>It is cooler to the north than the south</li>
        <li>There is a cold spot in the south</li>
    </ul>
    <li>Observing mature galaxies in the early universe has become a regular occurence<sup>[6][7][8][9][10][11][12][13][14][15][16][17][18]</sup></li>
    <ul>
    </ul>
    <li>More objects that surpass the theoretical size limit have been observed
        <sup>[19][20][21][22][23][24]</sup>
    </li>
</ul>

<p>These new observations run counter to the standard model, and the state of cosmology has officially been declared a crisis<sup>[25]</sup>.</p>
    
<p>Yet these new observations pose no threat to the decelerating photon model. 
    The CMB in the decelerating photon model is not the remnant of an ancient fireball that has traveled 14 billion light years to reach us.
    It's not of cosmological origin. It doesn't tell us what Hubble's constant is. And there's no reason it has to be the same temperature in all directions.
</p>

<p>Given these new observations and the issues they pose for the standard model of cosmology, 
    the remainder of this paper will attempt to address the issues of the decelerating photon hypothesis 
    and propose some ways to test it.
</p>

<hr>

<h2>Established Laws of Physics</h2>

<h3>Newton's First Law of Motion</h3>

<p>An object in motion remains in motion at a constant velocity. Presumably this should hold to infinity. And why should it not?
    It holds true for hundreds of light years. Millions even. Billions it seems.</p>

<p>How about 1 trillion light years? Does inertia hold true for 1 trillion light years?</p>

<p>We have no empirical evidence that tells us it does. That does not mean it doesn't. According to the standard model,
    light traveling for 14 billion light years approaches space that is expanding faster than the light can travel. 
    This is known as Hubble's limit. Light might possibly be able to travel for 1 trillion years at a constant speed, 
    but since any light from beyond 14 billion light years will never reach us due to the expansion of the universe,
    we would never know if it does or not.
</p>

<p>By pure coincidence, the universe is also only 14 billion years old. So there hasn't been 1 trillion years of time for light 
    to have even traveled 1 trillion light years. 
</p>

<p>For the decelerating photon hypothesis to be correct, one of two things must also be correct:</p>

<ol>
    <li>A dark force slows the photon</li>
    or
    <li>Inertia doesn't hold to infinity</li>
</ol>

<p>Given that dark matter and dark energy are options for cosmologists, a dark force with a direct measurable consequence (cosmological redshift)
    might seem the most likely solution to this problem.
</p>

<p>However, I recommend interpretation 2, that Newtontian dynamics does not hold for infinite distance. 
    If it's a dark force that keeps a photon from reaching beyond Hubble's limit,
    or even the expansion of space that causes the barrier, the motion of a photon is still effectively limited to a finite distance. 
</p>

<p>That said, a photon is not a Newtonian object. We only have evidence of photons traveling vast distances and arriving redshifted,
    not Newtonian objects. Perhaps this hypothesis only applies to photons? For that reason we will move on to relativity.</p>

<h3>Special Relativity</h3>

<p>The second postulate of special relativity is that the speed of light in a vacuum is always c in all frames. 
    And like Newtonian inertia, it is implied that this holds to infinite distance.</p>

<p>The hypothesis is that the velocity <code>v</code> of a photon is determined by its distance <code>D</code>:</p>

<p class="pimg"><img src="img/v=c-HD.png"></p>

<p>Whether the speed of light is <code>c</code> or <code>c - HD</code> only matters when distances are in the millions of light years
    and <code>HD</code> is large enough 
    to be noticed. For non-cosmological distances, <code>HD = 0</code> and <code>v = c</code>, 
    which is consistent with special relativity where it is experimentally confirmed.
</p>

<p>Testing the constancy of the speed of light from very distant sources is a topic in a later section of this paper.</p>

<h3>Conservation of Energy</h3>

<p>One criticism of the hypothesis is that the photon can't lose speed because then it loses energy, which violates the conservation of energy.
    However, the redshifting of photons is an observed fact of nature, and redshifted photons have less energy than non-redshifted photons.
    This seems to be the case for the standard model, according to Sean Carroll.</p>
    
    <blockquote>
    The thing about photons is that they redshift, losing energy as space expands. If we keep track of a certain fixed number of photons, the number stays constant while the energy per photon decreases, so the total energy decreases. A decrease in energy is just as much a “violation of energy conservation” as an increase in energy, but it doesn’t seem to bother people as much. At the end of the day it doesn’t matter how bothersome it is, of course — it’s a crystal-clear prediction of general relativity.
    </blockquote>

<a href="https://www.preposterousuniverse.com/blog/2010/02/22/energy-is-not-conserved/">https://www.preposterousuniverse.com/blog/2010/02/22/energy-is-not-conserved/</a>

<p>In a universe that is 14 billion years old, losing energy may not be a big deal. 
    But if the decelerating photon hypothesis is to be believed, the universe would not be 14 billion years old. 
    It would have no definitive age at all.
    If the universe were 10<sup>100</sup> years old, and photons lost energy, why is there anything left? Shouldn't the fire have gone out by now?
</p>

<p>The answer may be as simple as the energy deducted from the photon by redshifting is deposited into space.
    In this way, the energy of the universe stays the same. Energy leaves a star as light, dropping little bits of energy as it travels intergalactic space,
    energy that finds its way back into stars and repeats.
</p>

<p>If the loss of energy due to redshifting is a problem, the decelerating photon hypothesis has a solution, whereas the expanding models do not.</p>

<p>In fact, the expansion model from earlier is still running. The decelerating photon burned out long ago, but the photon in expanding space
    is traveling faster and farther, yet hasn't hit a target for hundreds of trillions of years.</p>

<p>
    Photon Distance: <span id="expanding-photon-distance"></span> million light years
<br>
Photon Speed: <span id="expanding-photon-speed"></span> c
<br>
Time since last target: <span id="expanding-last-target"></span> million years
<br>
<button id="stop-models-button">Stop</button>
</p>

<p>The photons in the expanding universe that approach the Hubble limit just cruise forever never hitting anything. 
    In the decelerating photon hypothesis, photons decay and get recycled back into the universe.
    The expanding universe is almost comically inefficient by comparison.   
</p>
<hr>

<h2>Big Bang Cosmology</h2>

<h3>Redshifts indicate an expanding universe</h3>

<p>The systemic cosmological redshifts first observed by Edwin Hubble are the observational foundations of an expanding universe.</p>

<p>In the expanding model, as the photon travels away from its source, space will expand in front of and behind the photon. 
    From the frame of reference of the source, the photon would actually appear to pick up speed away from it.
    This increase in speed can be taken as an increase in wavelength, the observed redshifts.
</p>

<p>If the original frequency or wavelength is known, using the equation for the velocity of wave 
    (<code>v = frequency &times; wavelength</code>) the expanding model can be updated to demonstrate the increased wavelength:</p>

<pre class="js"><code>photon.v = c + H * photon.d
photon.d += photon.v
photon.w = (photon.v * 299792458 / photon.f) 
</code></pre>

<p>Inversely, if the observed redshifts are taken as a decrease in frequency, 
    using the same equation (<code>v = frequency &times; wavelength</code>) the photon's velocity should decrease too. 
    If the original frequency or wavelength is known,
    the decelerating photon hypothesis can be modified to show the decreased frequency:
</p>
    
<pre class="js"><code>photon.v = c - H * photon.d
photon.d += photon.v
photon.f = (photon.v * 299792458 / photon.w) 
</code></pre>

<p>Using the new wavelengths and frequencies and the standard method of calculating redshift:</p>
    
<p class="pimg"><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6a999cd6480ab61dddeeb5372c8037c0d533f2c9"></p>

<p class="pimg"><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7cf28c6ce6fcc3087c62bf506432ce3381236738"></p>

<p>When we graph the z's predicted by each model, we find again that the models match exactly.</p>

<button id="set-y-axis">Set y-axis to red-shift</button>


<p>The redshifts predicted by the expanding model and the decelerating photon hypothesis are identical.
</p>


    <h3>The CMB indicates a hot past</h3>

    <p>The Big Bang theory didn't predict the right temperature for the CMB, which is understandable because Hubble's constant 
        was much higher in the early days of the theory. But the temperature discovered <i>was</i> 
        <a href="https://en.wikipedia.org/wiki/Cosmic_microwave_background#Timeline_of_prediction,_discovery_and_interpretation"
        >accurately predicted by several astronomers</a> working from non-expanding models</a><sup>[26]</sup>.</p>

    <p class="pimg"><img src="img/cmb_predictions.png"></p>

    <p>The CMB was discovered in 1964 at 2.8 K. The most accurate 
        predictions for the background temperature of space were based on a stationary universe, not an expanding one.</p>
    
    <p>That's a major coincidence. 
        If we were living 5 billion years from now, or 5 billion years in the past, the CMB would be a different temperature according to the Big Bang.
        It's pure coincidence that the CMB is the same temperature today as the minimum temperature for stuff in our galaxy.</p>

    <p>All of that could be ignored, but in the last decade anomalies have been spotted in the CMB<sup>[4][5]</sup>:</p>

    <blockquote>
        Two Cosmic Microwave Background anomalous features hinted at by Planck's predecessor, NASA's Wilkinson Microwave Anisotropy Probe (WMAP), 
        are confirmed in the new high precision data from Planck.  One is an asymmetry in the average temperatures on opposite hemispheres of the 
        sky, with slightly higher average temperatures in the southern ecliptic hemisphere and slightly lower 
        average temperatures in the northern ecliptic hemisphere. <b>This runs counter to the prediction made by the standard model that the Universe 
        should be broadly similar in any direction we look.</b> There is also a cold spot that extends over a patch of sky that is much larger 
        than expected. 
        <br>
        <a href="https://sci.esa.int/web/planck/-/51559-hemispheric-asymmetry-and-cold-spot-in-the-cosmic-microwave-background">
            https://sci.esa.int/web/planck/-/51559-hemispheric-asymmetry-and-cold-spot-in-the-cosmic-microwave-background</a>
    </blockquote>
    
    <p>The CMB is predicted to be the same temperature in all directions. It is not.</p>

    <p>We see a cold spot to the south. In the diagram, does the south observer see a cold spot to their south? 
        Does the north observer see the same CMB anomalies as we do?</p>
    
    <p class="pimg"><img src="img/cmbobservers.png"></p>
    
    <p>This is a question the expanding universe theory doesn't have a clear answer for.</p>
    
    <p>In the Milky Way galaxy, our sun is located slightly to the north of the galactic disk.</p>

    <p class="pimg"><img src="img/milkyway.png"></p>

    <p>That means, there are more stars of our own galaxy to the south than there are to the north. 
        And the CMB's southern hemisphere is warmer than the northern hemisphere.
        The CMB may be the heat of our own galaxy. </p>
    
    <p>Finally, it is the measurements of the CMB that aren't fitting measurements of Hubble's constant that is at the source of the 
        Hubble tension<sup>[3]</sup>. If the CMB is not an ancient fireball, there is no tension.</p>
        
    <h3>Age and size of the universe</h3>

    <p>If the universe started with a Big Bang, as we look back in space and time, 
        we should be seeing fewer and fewer mature galaxies, and eventually only young galaxies. 
        In the 21st century observations show that's not true<sup>[6][7][8][9][10][11][12][13][14][15][16][17][18]</sup>:</p>


    <ul>
        <li><a href="https://skyandtelescope.org/astronomy-news/dead-ringer-milky-way-found-early-universe/">"Dead Ringer" for the Milky Way Found in Early Universe</a></li>
        <li><a href="https://www.space.com/how-can-a-star-be-older-than-the-universe.html"> How Can a Star Be Older Than the Universe?</a></li>
        <li><a href="https://www.sciencedaily.com/releases/2015/03/150302122925.htm"> Old-looking galaxy in a young universe: Astronomers find dust in the early universe</a></li>
        <li><a href="https://www.newscientist.com/article/dn26856-ancient-planets-are-almost-as-old-as-the-universe/?ignored=irrelevant#.VMlP1PlVK1E"> Ancient planets are almost as old as the universe</a></li>
        <li>Lots more <a href="https://old.reddit.com/r/BigBangSkeptics">here.</a>
    </ul>

    <p>The size of the things we observe in the universe doesn't seem to be constrained by what we assume are the theoretical limits they could reach
        given the age and size of the universe<sup>[19][20][21][22][23][24]</sup>. From <a href="https://en.wikipedia.org/wiki/List_of_largest_cosmic_structures">Wikipedia</a>:</p>

        <p class="pimg"><img src="img/size_limit.png"></p>

    <p>And then there's the weird coincidence that the age of the universe is about equal to c/H, the 
        radius of <a href="https://en.wikipedia.org/wiki/Hubble_volume">the Hubble Volume</a>. 
        If we were living 5 billion years ago, or 5 billion years from now, the age of the universe and Hubble's radius would be unrelated.
        By <i>pure</i> coincidence, we are living when they match.</p>

    <h3>Tolman Surface Brightness Test</h3>

    <p>The Tolman Surface Brightness Test is meant to distinguish a static universe from an expanding one.</p>

    <p>In the decelerating photon hypothesis, a photon experiences the same delays in the journey as a photon would in expanding space. 
        But successive photons in an expanding universe would experience higher delays, whereas each successive photon in the decelerating photon hypothesis
        experiences the same delay as the first photon.</p>

    <button id="startButton">Run All</button> <button id="stopButton">Stop</button>
    <div id="freqtest"></div>

    <!--<p>You can see this in action on the <a href="freqtest.htm">Photon Arrival Rate page</a></p>-->

    <p>An expanding universe predicts an extra factor of dimming, due to the photons arriving at a lower rate due to the galaxy's motion away from us.
        Based on observations, it predicts one factor too many<sup>[27]</sup>:
    </p>
            
    <blockquote>"The exponent found is not 4 as expected in the simplest expanding model, but 2.6 or 3.4, depending on the frequency band."
        <br>
        <a href="https://en.wikipedia.org/wiki/Tolman_surface_brightness_test">https://en.wikipedia.org/wiki/Tolman_surface_brightness_test</a>
    </blockquote>

    <p>The decelerating photon hypothesis predicts one fewer factor than the expanding universe, matching observations.</p>



<hr>

<a name="tired-light"></a>
<h2>Comparison to other models</h2>

<h3>Tired Light</h3>

<p>There have been 
    hundreds of theories that don't involve expanding space
    trying to explain how light gets "tired" during long intergalactic journeys<sup>[28]</sup>, 
    starting all the way back in 1929 when the redshift-distance relation was first published.
</p>

<p>Tired light theories fail because they don't
    account for enough redshift, they can't explain the distance factor, or the redshifts are caused in a way that would include other observable results, 
    which ultimately are not observed.</p>

<p>In general, tired light theories have the following in common:</p>

<ul>
    <li>Some other phenomenon causes the redshifts</li>
    <li>Light always travels at <code>c</code>, even though it is "tired"</li>
    <li>There are no delays in light's journey, matching a simple static model</li> 
</ul>

<p>The hypothesis that light's speed is inversely proportional to the distance from its source is different:</p>

<ul>
    <li>Nothing causes the redshifts, they are as fundamental to nature as inertia</li>
    <li>Light travels at less than <code>c</code> after millions of years</li>
    <li>The time it takes light to reach a target is delayed, matching the expanding model</li> 
</ul>

<p>In this hypothesis, one could say light <i>does</i> get "tired",  
    but it does so in a way that is conceptually and mathematically unique to the established 
    <a href="https://en.wikipedia.org/wiki/Tired_light">Tired Light</a> theories.</p>

<a name="vsl"></a>
<h3>Varying Speed of Light (VSL)</h3>

<p>For the last few decades there have been versions of a theory going around known as Varying Speed of Light<sup>[29]</sup>:</p>

<blockquote><i>
    There are others that think such dark energy ideas are now getting too convoluted, and that a much simpler explanation, one that even Einstein considered, should now be given serious consideration; a change in the speed of light, or VSL (Varying Speed of Light) as others know it by.
<br>
<br>
... The differing values [in Hubble's constant] may be explained if the speed of light has changed between the early and late universe,” said Louise Riofrio, an author and scientist who now works at an observatory association in Hawaii. 
</i>
<br>
<br>
<a href=https://room.eu.com/news/as-mystery-of-the-universes-expansion-rate-widens-a-simple-solution-is-offered">As mystery of the Universe’s expansion rate widens, a simple solution is offered</a>
</blockquote>

<p>In VSL theories:</p>

<ul>
    <li><code>c</code> changes</li>
    <li><i>All</i> photons in the universe slow to the same speed </li>
    <li>Space is expanding</li>
    <li>Intends to represent the accelerating rate of expansion</li>
</ul>

<p>The hypothesis in this paper is different:</p>

<ul>
    <li><code>c</code> is constant</li>
    <li><i>Individual</i> photons slow down according to their own history, not the universe's</li>
    <li>Space is not expanding</li>
    <li>Intends to represent cosmological redshift</li>
</ul>

<p>The speed of light does vary in this hypothesis, but in a novel way to  
    <a href="https://en.wikipedia.org/wiki/Variable_speed_of_light">Varying Speed of Light</a> theories.</p>

<hr>

<a name="photon-treatment"></a>
<h2>Photons</h2>

<p>This model represents light at the individual photon level. 
    It's not a quantum theory, nor is it a relativistic theory, but it's also not completely classical. 
    To illustrate, the photon was defined as having a distance from its source.</p>

<pre><code>
photon = {
    distance: 0
}
</code></pre>

<p>Where is this photon? It doesn't have an <i>(x,y,z)</i> coordinate. Instead, it occupies every point around its source 
    at the specified distance.
    It's not a classical particle or wave in this form.</p> 

<p>Later, we added velocity, frequency, and wavelength to the photon.</p>

<pre><code>
photon = {
    distance: 0, 
    velocity: 1, 
    frequency: 6e5, 
    wavelength: 499.65
}
</code></pre>

<p>For the purposes of this model, the photon actually only needs distance and energy.</p>

<pre><code>
photon = {
    distance: 0, 
    energy: 2.48, 
}
</code></pre>
    
<p>We know from classical mechanics that the speed of a wave is its frequency &times; wavelength. 
    In quantum mechanics the <a href="https://en.wikipedia.org/wiki/Photon_energy">energy of a photon</a> is frequency &times; Planck's constant (<code>h</code>).
    And the decelerating photon hypothesis says the speed of a photon is <code>c - HD</code>. Given these formulas:</p>

<pre>
    speed of a photon     v = c - HD
    speed of wave         v = f &times; w 
    energy of a photon    E = h &times; f 
</pre>

</p>the photon's velocity, frequency, and wavelength can be determined at any time from its distance and initial energy.</p>

<p>The photon's distance from where it was emitted is crucial to keep in mind at all times. 
    Consider light that has traveled billions of years to reach your telescope. 
    The light enters the lens, gets focused to the eyepiece, and then into your eyeball.</p>

<p>Seems pretty straightforward. But at some level, some type of interaction with the light and the lens must be focusing the light. 
    At the quantum level, the photon will have been <a href="http://hyperphysics.phy-astr.gsu.edu/hbase/mod5.html">absorbed by atoms</a> in the lens. 
        Then it is re-emitted (or an entirely new photon is emitted), and focused to your telescope's eyepiece.</p>

<p>The photon may have traveled great distances from its source before it encountered your telescope, 
    but the light inside the telescope will be very close to its source: the lens that focused it. 
    The distance to the source of the photons in the telescope will be less than a meter, not millions of light years.</p>

<p>In that case the refreshed photon will be traveling at <code>c</code>, which now results in an elongated wavelength when calculated.</p>


<hr>

<a name="tests"></a>
<h2>Tests</h2>

<h3>Test 1: measure the speed of a cosmologically red-shifted photon</h3>

<p>This is the first obvious test of the hypothesis.</p>

<p>But it would take thousands or millions of years to perform a fully controlled experiment where light is emitted with a known energy at a 
    known time and travels across a known distance to see the effects of red-shift.</p>
    
<p>Using light that has already traveled millions of years seems to be the only choice.</p>

<p>But interacting with the photon will cause it to reset its distance and speed, as mentioned in the previous section. 
    The task then is to come up with a clever way to measure the speed of ancient light without disturbing the photon.
</p>

<p>Consider a long tube in space with a telescope at one end and an open shutter at the other. 
    The telescope has a nearby galaxy and a highly red-shifted galaxy in its sight. </p>

<p class="pimg">
    <img src="img/experiment1.png">
<p>

<p>What happens when the shutter is closed?</p>

<p><b>Prediction:</b> Because the red light is moving slower than the yellow light, first the nearby galaxy will disappear from view, then the distant one.</p>

<h3>Test 2: extra doppler shifts from high z galaxies</h3> 

<p>Because photons from high z galaxies should be moving slower than c, their relative velocity to Earth should be detectable
    by the Hubble Space Telescope as Doppler effects. </p>
    
    <p><b>Prediction:</b> Observing a high z galaxy on Earth's horizon, when Earth is on opposite sides of the sun,
    should produce more redshift when the Earth is moving away from the distant galaxy than when the Earth is moving toward the galaxy, to a degree
    more exaggerated than for nearby galaxies.
</p>

<p class="pimg">
    <img src="img/dopplertest.png">
<p>

<h3>Test 3: deviations from the standard model</h3> 

<p>The decelerating photon hypothesis is identical to the expanding model provided here. However, the expanding model
    provided here is much simpler than the standard model of cosmology, with its dark matter and dark energy components. </p>
    
<p>To compare the hypothesis with the standard model, the following chart of z, lookback time, and co-moving distance was made using  
     <a href="https://www.wolframalpha.com">WolframAlpha</a> for the standard model. 
     See the <a href="notes/zdata_full">full list of data and sources</a>. 
     Units are billion years and billion light years.</p>

<pre>
                     
    z       [H=74 lookback     co-distance]   [H=67.4 lookback    co-distance]
    --------------------------------------------------------------------------
     1              7.4        10.4                    8.1        11.4 
     2              9.8        16.4                   10.8        18.0 
     3             11.0        20.1                   12.1        22.1 
     4             11.6        22.8                   12.7        25.0 
     5             11.9        24.7                   13.1        27.1 
     6             12.2        26.2                   13.4        28.8 
     7             12.3        27.5                   13.5        30.2 
     8             12.4        28.5                   13.7        31.3 
     9             12.5        29.4                   13.8        32.2 
    10             12.6        30.1                   13.8        33.0 
    11             12.7        30.7                   13.9        33.8 
    12             12.7        31.3                   14.0        34.4 
    13             12.7        31.8                   14.0        34.9 
    14             12.8        32.3                   14.0        35.4 
    15             12.8        32.7                   14.1        35.9 
    16             12.8        33.1                   14.1        36.3 
    17             12.8        33.4                   14.1        36.7 
    18             12.9        33.7                   14.1        37.0 
    19             12.9        34.0                   14.1        37.4 
    20             12.9        34.3                   14.2        37.7 
    21             12.9        34.6                   14.2        37.9 
    22             12.9        34.8                   14.2        38.2 
    23             12.9        35.0                   14.2        38.4 
    24             12.9        35.2                   14.2        38.7 
    25             12.9        35.4                   14.2        38.9
</pre>

<p>
    In the expanding model, the lookback time refers to how long ago the light was emitted, and the co-moving distance refers to 
    how far away the light source is now, given that space has expanded since the light was emitted.
</p>

<p>
    In the decelerating photon hypothesis, the time it takes to make the journey increases due to the photon slowing down.
    A distant light source won't have moved from expansion between then and now (though it may have its own particular motion).
    In this case distance and duration trade places.
    The lookback time correlates with the distance of the target, and the co-moving distance correlates with the time
    it takes to reach the target.
    
</p>
    
<p class="pimg">
    <a href="img/graph_distance_z.png"><img width="345" src="img/graph_distance_z.png"></a>
    <a href="img/graph_time_z.png"><img width="345" src="img/graph_time_z.png"></a>
<br>green = decelerating photon hypothesis, white dots = standard model via WolframAlpha
<br> lookback (left) co-moving distance (right)</p>

<p>At about a z of 8.0, the hypothesis starts to go off the path of the standard model, predicting a slower rise in z over time. 
    In other words, this hypothesis predicts more redshift nearby and less far away than the standard model, giving it the illusion
    that the effect is currently accelerating compared to expectations.
</p>

<h3>Test 4: breadcrumbs</h3> 

<p>If the photon has less energy when it arrives than when it left, what about the missing energy? 
    If the universe were trillions of trillions of years old, and light kept losing energy all over the place, you would think there would be barely
    anything left in existence by now.
</p>

<p>For this reason, it seems sensible that any energy deducted from the photon during its journey through space might be deposited along its path, 
    like a trail of breadcrumbs. Overtime, this discarded energy could coalesce into something larger.
</p>

<p>This might be supported by observations of walls and filaments of galaxies:</p>

<blockquote>
    <i>An analysis of thousands of galaxies finds that they are strung like pearls on a necklace, even on relatively small scales.

        <br>
        <br>
        On large scales, the universe is comprised of empty voids, punctuated by narrow, winding filaments of dark matter that guide the growth of galaxies and galaxy clusters. This cosmic web, which has taken decades to map, holds a repeating pattern on the order of hundreds of millions of light years.

    </i>
    <br>
    <br>
    <a href="https://www.newscientist.com/article/dn26598-galaxies-in-filaments-spaced-like-pearls-on-a-necklace/">Galaxies in filaments spaced like pearls on a necklace</a>
</blockquote>

<p>Although, how that could be made into a quantifiable prediction is presently unclear.</p>
<!--

<h3>Test 4: Close range red-shift</h3>

<p>While hypothesis 1 predicts the same red-shifts as the expanding model, hypothesis 2 shows us something a little different. 
    The red-shifts predicted by hypothesis seem to have a late start, which we can see by zooming into the first few billion years of the graph.
</p>

<p class="pimg">
    <img src="img/graph_redshift_zoom.png">
</p>

<p>The green and white lines can be made by either hypothesis 1 or the expanding model. 
    Green is for H = 74 km/s/Mpc, and white is for H = 67 km/s/Mpc. The red line represents hypothesis 2.</p>

<p>As you can see from the red line, it has a slower start than the other models. There is very little red-shift for the first billion years.</p>

<p>Then hypothesis 2 comes back and catches up to the green line, H = 74 km/s/Mpc. It follows the green line for a bit, 
    before jumping over to the white line, H = 67 km/s/Mpc. Then it does its own thing and flattens out.</p>

<p>work in progress</p>

-->
<hr>

<h2>Conclusion</h2>

<blockquote>
    <i>We seem to face, as once before in the days of Copernicus, a choice between a small, finite universe, 
    and a universe indefinitely large plus a new principle of nature.</i> 
    <br>
    -Edwin Hubble, pg. 52

</blockquote>

<p>Cosmological redshifts have been a known, observed fact since 1929.</p>

<p>We could assume the redshifts indicate motion, which means:</p> 

<ul>
    <li>the universe is expanding</li>
    <li>there are age and size limits to the universe</li>
    <li>the universe inflated in the first nanosecond</li>
    <li>it is dominated by dark matter and dark energy</li>
    <li>it's currently accelerating</li>
</ul>

<p>Or we could assume the redshifts are themselves a new feature of the universe, which means:</p>

<ul>
    <li>light doesn't travel to infinity at a constant speed</li>
    <li>what we can see is an insignificant sample of an indefinitely large and old universe</li>
</ul>

<p>When interpreting the red-shifts as Doppler effects in the 20th century, astronomers didn't know this idea 
    would lead to inflation or dark energy. In fact, they chose the velocity-shift interpretation because it 
    was known and familiar and didn't require new laws of physics.</p>

<p>In retrospect, it should come as no surprise to us that when telescopes could show us what's beyond the Milky Way,
    they would also reveal a new fundamental law of nature.</p>

<p>If dark energy is in the consideration as a possible fundamental ingredient of nature despite having never been observed, 
    then the actual observations that led to its conjecture, cosmological redshift, should be considered as well.</p>

<br>

<hr>

<p>Questions, comments, concerns?</p>
<ul>
    <li>Create a <a href="https://github.com/mikehelland/hubbles-law/issues">GitHub Issue</a> to leave peer review</li>
    <li>Contact: <a href="mailto:mike@mikehelland.com">mike@mikehelland.com</a></li>
</ul>

<hr>

<h2>More:</h2>

<ul>
    <li><a href="test.htm">The Testing Page</a> - try your own hypotheses and values, more models and options</li>
    <li><a href="https://github.com/mikehelland/hubbles-law/blob/master/test.htm">Source code for the models</a> on GitHub.</li>
    <li><a href="redshift.htm">Understanding Cosmological Red-shift</a></li>
    <li><a href="bigbang.htm">History and context of the Big Bang</a></li>
</ul>

<hr>

<h2>Sources</h2>


<ol>
    <li>
        A. G. Riess et al. [Supernova Search Team], <i>Astron. J.</i>, 116, 1009 (1998).
    </li>
    <li>
        N. Aghanim et al., <i>“Planck 2018 results. VI. Cosmological parameters</i>, (2018)
    </li>
    <li>
        A. G. Riess et al., <a href="https://arxiv.org/abs/2012.08534">arXiv:2012.08534 [astro-ph.CO]</a> <i>ApJ.</i>, 116, 1009 (2020).
    </li>
    <li>
        Cruz, M.; Martinez-Gonzalez, E.; Vielva, P.; Cayon, L. (2005). "Detection of a non-Gaussian Spot in WMAP". <i>Monthly Notices of the Royal Astronomical Society</i>. <b>356</b> (1): 29–40. <a href="/wiki/ArXiv_(identifier)" class="mw-redirect" title="ArXiv (identifier)">arXiv</a>:<span class="cs1-lock-free" title="Freely accessible"><a rel="nofollow" class="external text" href="//arxiv.org/abs/astro-ph/0405341">astro-ph/0405341</a></span>. <a href="/wiki/Bibcode_(identifier)" class="mw-redirect" title="Bibcode (identifier)">Bibcode</a>:<a rel="nofollow" class="external text" href="https://ui.adsabs.harvard.edu/abs/2005MNRAS.356...29C">2005MNRAS.356...29C</a>. <a href="/wiki/Doi_(identifier)" class="mw-redirect" title="Doi (identifier)">doi</a>:<a rel="nofollow" class="external text" href="https://doi.org/10.1111%2Fj.1365-2966.2004.08419.x">10.1111/j.1365-2966.2004.08419.x</a>.
    </li>
    <li>
        Ade, P. A. R.;  et al. (Planck Collaboration) (2013). "Planck 2013 results. XXIII. Isotropy and statistics of the CMB". <i>Astronomy &amp; Astrophysics</i>. <b>571</b>: A23. <a href="/wiki/ArXiv_(identifier)" class="mw-redirect" title="ArXiv (identifier)">arXiv</a>:<span class="cs1-lock-free" title="Freely accessible"><a rel="nofollow" class="external text" href="//arxiv.org/abs/1303.5083">1303.5083</a></span>. <a href="/wiki/Bibcode_(identifier)" class="mw-redirect" title="Bibcode (identifier)">Bibcode</a>:<a rel="nofollow" class="external text" href="https://ui.adsabs.harvard.edu/abs/2014A&amp;A...571A..23P">2014A&amp;A...571A..23P</a>. <a href="/wiki/Doi_(identifier)" class="mw-redirect" title="Doi (identifier)">doi</a>:<a rel="nofollow" class="external text" href="https://doi.org/10.1051%2F0004-6361%2F201321534">10.1051/0004-6361/201321534</a>.
    </li>


<!-- mature galaxies in a young universe -->

    <li>
        Neeleman, M., Prochaska, J.X., Kanekar, N. et al. A cold, massive, rotating disk galaxy 1.5 billion years after the Big Bang. Nature 581, 269–272 (2020). 
        <a href="https://doi.org/10.1038/s41586-020-2276-y">https://doi.org/10.1038/s41586-020-2276-y</a>
    </li>
    <li>
        Marco  Mignoli, et al., A&A 642 L1 (2020) DOI: 10.1051/0004-6361/202039045
        Web of the giant: Spectroscopic confirmation of a large-scale structure around the z = 6.31 quasar SDSS J1030+0524
    </li>
    <li>
        Rizzo, F., Vegetti, S., Powell, D. et al. A dynamically cold disk galaxy in the early Universe. Nature 584, 201–204 (2020). 
        <a href="https://doi.org/10.1038/s41586-020-2572-6">https://doi.org/10.1038/s41586-020-2572-6</a>
    </li>
    <li>
        Don A. VandenBerg et al 2014 ApJ 792 110 
        <a href="http://dx.doi.org/10.1088/0004-637X/792/2/110">http://dx.doi.org/10.1088/0004-637X/792/2/110</a>
    </li>
    <li>
        Wang, T., Schreiber, C., Elbaz, D. et al. A dominant population of optically invisible massive galaxies in the early Universe. Nature 572, 211–214 (2019). 
        <a href="https://doi.org/10.1038/s41586-019-1452-4">https://doi.org/10.1038/s41586-019-1452-4</a>
    </li>
    <li>
        K. Caputi et al., “Spitzer Bright, UltraVISTA Faint Sources in COSMOS: The Contribution to the Overall Population of Massive Galaxies at z = 3-7”, Astrophysical Journal.
    </li>
    <li>
        P. L. Capak et al. “Galaxies at redshifts 5 to 6 with systematically low dust content and high [CII] emission.” Nature. June 25, 2015.
    </li>
    <li>
        Adi Zitrin et al 2015 ApJL 810 L12 
        <a href="https://iopscience.iop.org/article/10.1088/2041-8205/810/1/L12">https://iopscience.iop.org/article/10.1088/2041-8205/810/1/L12</a>
    </li>
    <li>
        Watson, D., Christensen, L., Knudsen, K. et al. A dusty, normal galaxy in the epoch of reionization. Nature 519, 327–330 (2015). 
        <a href="https://doi.org/10.1038/nature14164">https://doi.org/10.1038/nature14164</a>
    </li>
    <li>
        Straatman, Caroline MS, et al. "A substantial population of massive quiescent galaxies at z∼ 4 from ZFOURGE." The Astrophysical Journal Letters 783.1 (2014): L14. 
        <a href="https://arxiv.org/abs/1312.4952">https://arxiv.org/abs/1312.4952</a>
    </li>
    <li>
        B. D. Simmons et al. Galaxy Zoo: CANDELS Barred Disks and Bar Fractions. Monthly Notices of the Royal Astronomical Society, 2014 DOI: 10.1093/mnras/stu1817
    </li>
    <li>
        Charles L. Steinhardt et al 2014 ApJL 791 L25 
        <a href="https://iopscience.iop.org/article/10.1088/2041-8205/791/2/L25">https://iopscience.iop.org/article/10.1088/2041-8205/791/2/L25</a>
    </li>
    <li>
        J.  Setiawan, et al., Planetary companions around the metal-poor star HIP 11952, A&A 540 A141 (2012) DOI: 10.1051/0004-6361/201117826
    </li>

    <!-- too big -->

    <li>
        Daniel Pomarède et al 2020 ApJ 897 133 
        <a href="https://iopscience.iop.org/article/10.3847/1538-4357/ab9952">https://iopscience.iop.org/article/10.3847/1538-4357/ab9952</a>
    </li>
    <li>
        Gott, J. Richard, III;  et al. (May 2005), "A Map of the Universe", <i>The Astrophysical Journal</i>, <b>624</b> (2): 463–484, <a href="/wiki/ArXiv_(identifier)" class="mw-redirect" title="ArXiv (identifier)">arXiv</a>:<span class="cs1-lock-free" title="Freely accessible"><a rel="nofollow" class="external text" href="//arxiv.org/abs/astro-ph/0310571">astro-ph/0310571</a></span>, <a href="/wiki/Bibcode_(identifier)" class="mw-redirect" title="Bibcode (identifier)">Bibcode</a>:<a rel="nofollow" class="external text" href="https://ui.adsabs.harvard.edu/abs/2005ApJ...624..463G">2005ApJ...624..463G</a>, <a href="/wiki/Doi_(identifier)" class="mw-redirect" title="Doi (identifier)">doi</a>:<a rel="nofollow" class="external text" href="https://doi.org/10.1086%2F428890">10.1086/428890</a>
    </li>
    <li>
        Clowes, Roger; Luis E. Campusano; Matthew J. Graham &amp; Ilona K. S¨ochting (2012). "Two close Large Quasar Groups of size ∼ 350 Mpc at z ∼ 1.2". <i>Monthly Notices of the Royal Astronomical Society</i>. <b>419</b> (1): 556. <a href="/wiki/ArXiv_(identifier)" class="mw-redirect" title="ArXiv (identifier)">arXiv</a>:<span class="cs1-lock-free" title="Freely accessible"><a rel="nofollow" class="external text" href="//arxiv.org/abs/1108.6221">1108.6221</a></span>. <a href="/wiki/Bibcode_(identifier)" class="mw-redirect" title="Bibcode (identifier)">Bibcode</a>:<a rel="nofollow" class="external text" href="https://ui.adsabs.harvard.edu/abs/2012MNRAS.419..556C">2012MNRAS.419..556C</a>. <a href="/wiki/Doi_(identifier)" class="mw-redirect" title="Doi (identifier)">doi</a>:<a rel="nofollow" class="external text" href="https://doi.org/10.1111%2Fj.1365-2966.2011.19719.x">10.1111/j.1365-2966.2011.19719.x</a>.
    </li>
    <li>
        Clowes, Roger G.; Harris, Kathryn A.; Raghunathan, Srinivasan; Campusano, Luis E.; Söchting, Ilona K.; Graham, Matthew J. (2013-01-11). <a rel="nofollow" class="external text" href="http://mnras.oxfordjournals.org/content/early/2013/01/07/mnras.sts497.full">"A structure in the early Universe at z ∼ 1.3 that exceeds the homogeneity scale of the R-W concordance cosmology"</a>. <i>Monthly Notices of the Royal Astronomical Society</i>. <b>1211</b> (4): 6256. <a href="/wiki/ArXiv_(identifier)" class="mw-redirect" title="ArXiv (identifier)">arXiv</a>:<span class="cs1-lock-free" title="Freely accessible"><a rel="nofollow" class="external text" href="//arxiv.org/abs/1211.6256">1211.6256</a></span>. <a href="/wiki/Bibcode_(identifier)" class="mw-redirect" title="Bibcode (identifier)">Bibcode</a>:<a rel="nofollow" class="external text" href="https://ui.adsabs.harvard.edu/abs/2013MNRAS.429.2910C">2013MNRAS.429.2910C</a>. <a href="/wiki/Doi_(identifier)" class="mw-redirect" title="Doi (identifier)">doi</a>:<a rel="nofollow" class="external text" href="https://doi.org/10.1093%2Fmnras%2Fsts497">10.1093/mnras/sts497</a>. <a href="/wiki/S2CID_(identifier)" class="mw-redirect" title="S2CID (identifier)">S2CID</a>&nbsp;<a rel="nofollow" class="external text" href="https://api.semanticscholar.org/CorpusID:486490">486490</a><span class="reference-accessdate">. Retrieved <span class="nowrap">14 January</span> 2013</span>.
    </li>
    <li>
        Balazs, L.G.; Bagoly, Z.; Hakkila, J.E.; Horvath, I.; Kobori, J.; Racz, I.I.; Toth, L.V. (2015-08-05). <a rel="nofollow" class="external text" href="http://mnras.oxfordjournals.org/content/452/3/2236.abstract">"A giant ring-like structure at 0.78 &lt; z &lt; 0.86 displayed by GRBs"</a>. <i>Monthly Notices of the Royal Astronomical Society</i>. <b>452</b> (3): 2236–2246. <a href="/wiki/ArXiv_(identifier)" class="mw-redirect" title="ArXiv (identifier)">arXiv</a>:<span class="cs1-lock-free" title="Freely accessible"><a rel="nofollow" class="external text" href="//arxiv.org/abs/1507.00675">1507.00675</a></span>. <a href="/wiki/Bibcode_(identifier)" class="mw-redirect" title="Bibcode (identifier)">Bibcode</a>:<a rel="nofollow" class="external text" href="https://ui.adsabs.harvard.edu/abs/2015MNRAS.452.2236B">2015MNRAS.452.2236B</a>. <a href="/wiki/Doi_(identifier)" class="mw-redirect" title="Doi (identifier)">doi</a>:<a rel="nofollow" class="external text" href="https://doi.org/10.1093%2Fmnras%2Fstv1421">10.1093/mnras/stv1421</a>. <a href="/wiki/S2CID_(identifier)" class="mw-redirect" title="S2CID (identifier)">S2CID</a>&nbsp;<a rel="nofollow" class="external text" href="https://api.semanticscholar.org/CorpusID:109936564">109936564</a><span class="reference-accessdate">. Retrieved <span class="nowrap">5 August</span> 2015</span>.
    </li>
    <li>
        Horvath, Istvan; Bagoly, Zsolt; Hakkila, Jon; Tóth, L. Viktor (2014). "Anomalies in the GRB spatial distribution". <i>Proceedings of Science</i>: 78. <a href="/wiki/ArXiv_(identifier)" class="mw-redirect" title="ArXiv (identifier)">arXiv</a>:<span class="cs1-lock-free" title="Freely accessible"><a rel="nofollow" class="external text" href="//arxiv.org/abs/1507.05528">1507.05528</a></span>. <a href="/wiki/Bibcode_(identifier)" class="mw-redirect" title="Bibcode (identifier)">Bibcode</a>:<a rel="nofollow" class="external text" href="https://ui.adsabs.harvard.edu/abs/2014styd.confE..78H">2014styd.confE..78H</a>.
    </li>

    <li>
        Jones, David, "Crisis in Cosmology: Measuring The Local Value of the Hubble Constant"  
        APS April Meeting 2018 63,4 <a href="http://meetings.aps.org/Meeting/APR18/Session/H07.1">APR18-2018-000816</a> (2018)
    </li>


    <li>
        Assis, A. K. T.; Neves, M. C. D., Astrophysics and Space Science, Volume 227, Issue 1-2, pp. 13-24 (1995)
    </li>


    <li>
        Lubin, L. M.; Sandage, A., "The Tolman Surface Brightness Test for the Reality of the Expansion. IV. A Measurement of the Tolman Signal and the Luminosity Evolution of Early-Type Galaxies," Astronomical Journal, 122 (2001): 1084-1103.
    </li>

    <li>
        H.J. Reboul, <i><a href="https://ui.adsabs.harvard.edu/abs/1981A%26AS...45..129R/abstract">Astron. Astrophys. Supp. Ser.</a></i> 45, 129--144 (1981).
    </li>
    <li>
        J. Magueijo, <i>Reports on Progress in Physics</i>, Vol. 66, Iss. 11, 2025-2068 (2003).
    </li>


    <li>
        E. Hubble, in <i><a href="https://ned.ipac.caltech.edu/level5/Sept04/Hubble/paper.pdf">The Observational Approach to Cosmology</a></i>, p22, (1937)
    </li>
</ol>

<hr>

<h2>Change Log:</h2>

<ul>
    <li><i>01 Jan 2021</i> - Rewrite. </li>
    <li><i>28 Nov 2020</i> - Revised Original. </li>
    <li><i>12 Nov 2020</i> - Original. </li>
</ul>

</div>

<div id="right">
    <canvas id="graph" height="600" width="600"></canvas>
    <br>
    <div id="y-axis">
        Y-axis: <select id="graph-y-axis">
            <option>time to target (billions of years)</option>
            <option>z red-shift</option>
        </select>
    </div>
</div>

<script>

    var graph = document.getElementById("graph")
    var ctxG = graph.getContext("2d")
    var models = []
    
    var yAxis = document.getElementById("graph-y-axis")
    yAxis.selectedIndex = 0
    document.getElementById("set-y-axis").onclick = e => {
        yAxis.selectedIndex = 1
        document.getElementById("y-axis").style.display = "block"
    }
    
    // the models advance by 1 million years each step
    // the units for distance are in Mly (million light years)

    // the speed of light is 1 million lightyears per 1 million years
    // Hubble's Constant is in units of Mly^-1 

    var c = 1

    var zoom = 0.046
    var zoomG = zoom * 0.75
    var zoomGY = zoom * 0.28
    var offset = 20
    
    var dgi
    function drawGraph() {
        
        ctxG.lineWidth = 1

        ctxG.fillStyle = "black"
        ctxG.fillRect(0, 0, graph.width, graph.height)

        ctxG.fillStyle = "white"

        ctxG.strokeStyle = "white" 
        ctxG.strokeRect(offset, -10, graph.width, graph.height + 10 - offset)
        
        ctxG.lineWidth = 2
        for (var m = 0; m < models.length; m++) {
            ctxG.strokeStyle = models[m].color
            ctxG.beginPath()
            ctxG.moveTo(offset, graph.height - offset)
            for (var i = 0; i < models[m].targets.length; i++) {
                if (models[m].targets[i].hit) {
                    //ctxG.lineTo(offset + models[m].targets[i].start * zoomG, -offset + graph.height - models[m].targets[i].hit * zoomGY)
                    if (yAxis.selectedIndex === 0) {
                        ctxG.lineTo(offset + models[m].targets[i].start * zoomG, 
                                    -offset + graph.height - models[m].targets[i].hit * zoomGY)
                    }
                    else if (yAxis.selectedIndex === 1) {
                        // show the difference in time with a static model
                        ctxG.lineTo(offset + models[m].targets[i].start * zoomG, -offset + graph.height - 
                        models[m].targets[i].z * 10000
                            * zoomGY)
                    }
                }
            }
            ctxG.stroke()            
        }

        ctxG.fillText(yAxis.value, offset + 5, offset)
        ctxG.fillText("starting distance to target (billion light years)", graph.width - 240, graph.height - 30)
        
        if (yAxis.selectedIndex === 0) {
            for (dgi = 0; dgi < 80; dgi+=5) {
                ctxG.fillText(dgi, 4, -offset + graph.height - dgi * 1000 * zoomGY + 4)    
            }
        }
        else {
            for (dgi = 0; dgi < 110; dgi+=2) {
                ctxG.fillText(dgi / 10, 4, -offset + graph.height - dgi / 10 * 10000 * zoomGY + 4)    
            }
        }

        for (dgi = 0; dgi < 16; dgi+=2) {
            ctxG.fillText(dgi, offset + dgi * 1000 * zoomG, graph.height - 5)    
        }
    }

    function setupModel(model) {
        
        var playButton = document.createElement("button")
        playButton.innerHTML = "Click HERE to run"
        playButton.onclick = () => {
            if (playButton.innerHTML === "Reset") {
                playButton.innerHTML = "Click HERE to run"
                resetModel(model)
                draw(model.ctx, model)
            }
            else {
                runModel(model)
                playButton.innerHTML = "Reset"
            }
        }

        model.canvas = document.createElement("canvas")

        model.div.appendChild(playButton)
        model.div.appendChild(model.canvas)

        model.ctx = model.canvas.getContext("2d")
        model.nextTarget = 0

        model.canvas.width = 700
        model.canvas.height = 40
        
        // make a target every 200 million light years 
        model.targets = []
        for (var i = 200; i <= 26800; i+=200) {
            model.targets.push({label: i/1000, start: i, x: i})
        }

        model.ctx.font = "8px sans-serif"

        draw(model.ctx, model)

        models.push(model)
    }

    function draw(ctx, exp) {

        ctx.fillStyle = "black"
        ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height)

        for (var i = 0; i < exp.targets.length; i++) {
            if (exp.targets[i].hit) {
                ctx.strokeStyle = exp.color
                ctx.lineWidth = 3
            }
            else {
                ctx.strokeStyle = "white"
                ctx.lineWidth = 2
            }
            ctx.beginPath()
            ctx.moveTo(exp.targets[i].x * (exp.zoom || zoom), 0)
            ctx.lineTo(exp.targets[i].x * (exp.zoom || zoom), ctx.canvas.height)
            
            ctx.stroke()
        }

        ctx.fillStyle = "yellow"
        ctx.fillRect(exp.photon.x * (exp.zoom || zoom) - 2, ctx.canvas.height / 2, 5, 5)
    }

    function resetModel(model) {
        model.running = false
        model.photon.x = 0
        model.photon.dx = c
        model.nextTarget = 0
        model.targets.forEach(target => {
            target.x = target.start
            target.hit = 0
        })
    
        model.t = 0
    }

    function runModel(model) {
        
        resetModel(model)

        model.running = true

        var i, v, z
        var batch = 30
        var handle = setInterval(function () {
            for (i = 0; i < batch; i++) {
                if (model.running && model.targets[model.nextTarget]) {// && model.t < 80000) {
                    model.t++
                    model.next()

                    if (model.targets[model.nextTarget].x <= model.photon.x) {
                        model.targets[model.nextTarget].hit = model.t

                        if (model.photon.f_init) {
                            z = (model.photon.f_init - model.photon.f) / model.photon.f
                        }
                        else if (model.targets[model.nextTarget].dx) {
                            v = 1 - model.targets[model.nextTarget].dx 
                            z = (1 - v) / v
                        }
                        else {
                            v = model.photon.dx
                            z = (1 - v) / v
                        }
                        model.targets[model.nextTarget].z = z || 0
                        model.nextTarget++
                        model.lastTarget = model.t
                    }
                }
                else {
                    clearInterval(handle)
                    model.running = false
                }
            }
        }, 0)
    }

    setupModel({
        div: document.getElementById("staticModel"),
        name: "Static",
        color: "blue", 
        photon: {x: 0},
        next: function () {
            this.photon.x += c
        }
    })
    var expandingModel = {
        div: document.getElementById("expandingFast"),
        name: "Expanding Fast",
        color: "#888888", 
        H: 0.000076,
        photon: {x: 0, f_init: 6e5, w: 499.65},
        //zoom: 0.03,
        next: function () {
            this.photon.dx = c + this.photon.x * this.H
            this.photon.x += this.photon.dx
            this.photon.w = (this.photon.dx * 299792458 / this.photon.f_init) 
            this.photon.f = 299792458 / this.photon.w
            
            for (var i = 0; i < this.targets.length; i++) {
                this.targets[i].dx = this.targets[i].x * this.H
                this.targets[i].x += this.targets[i].dx
            }
        }
    }
    setupModel(expandingModel)
    var expandingPhotonSpeed = document.getElementById("expanding-photon-speed")
    var expandingPhotonDistance = document.getElementById("expanding-photon-distance")
    var expandingLastTarget = document.getElementById("expanding-last-target")

    var expandingEnergyInterval = setInterval(() => {
        expandingPhotonDistance.innerHTML = Math.floor(expandingModel.photon.x)        
        expandingPhotonSpeed.innerHTML = Math.floor(expandingModel.photon.dx)
        expandingLastTarget.innerHTML = expandingModel.t - expandingModel.lastTarget

    }, 500)
    
    setupModel({
        div: document.getElementById("redshift1"),
        name: "Redshift by distance",
        color: "green", 
        H: 0.000076,
        photon: {x: 0, dx: c, f_init: 6e5, w: 499.65},
        next: function () {
            //this.photon.x += c - this.H * this.photon.x
            this.photon.v = c - this.H * this.photon.x
            this.photon.x += this.photon.v
            this.photon.f = this.photon.v * 299792458 / this.photon.w
        }
    })

    setInterval(() => {
        for (var m = 0; m < models.length; m++) {
            if (models[m].running) {
                draw(models[m].ctx, models[m]) 
            }
        }

        drawGraph()
    }, 1000 / 60)

    document.getElementById("stop-models-button").onclick = () => {
        for (var m = 0; m < models.length; m++) {
            models[m].running = false
        }
        clearInterval(expandingEnergyInterval)
    }
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.4.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script src="freqtest.js"></script>