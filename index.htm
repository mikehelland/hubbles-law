<!DOCTYPE html>
<html>
    <head>
        <meta property="og:image" content="https://mikehelland.github.io/hubbles-law/img/hubbleslaws_graph.png"/>
        <meta property="og:description" content="A demonstration of Hubble's tension and its resolution."/>
        <meta property="og:title" content="Fixing Hubble's Law"/>
        <meta property="og:url" content="https://mikehelland.github.io/hubbles-law/"/>
        <style>
            body {
                background-color: #CCCCCC;
                color:black;
            }
            #graph {
                position:fixed;
                left:850px;
                top:10px;
                height:600px;
                width: 600px;
            }

            .text {
                background-color: white;
                max-width: 800px;
                font-family: Arial, Helvetica, sans-serif;
                padding: 15px;
            }

            .pimg  {
                text-align: center;
            }
        </style>

    </head>
<body>

<!-- HELLO!!! Source code for the models at the bottom -->

<div class="text">
<h1>Fixing Hubble's Law</h1>

<p>Finding the right value for Hubble's Constant has been difficult. </p>

<ul>
    <li><a href="https://www.livescience.com/hubble-constant-crisis-deepens.html">No One Can Agree How Fast Universe Is Expanding. New Measure Makes Things Worse.</a></li>
    <li><a href="https://www.aps.org/publications/apsnews/201805/hubble.cfm">Hubble Trouble: A Crisis in Cosmology?</a></li>
    <li><a href="https://www.scientificamerican.com/article/best-yet-measurements-deepen-cosmological-crisis/">Best-Yet Measurements Deepen Cosmological Crisis</a></li>
    <li>Video: <a href="https://www.youtube.com/watch?v=72cM_E6bsOs">PBS Space Time: The Crisis in Cosmology</a></li>
    <li>More at <a href="https://duckduckgo.com/?q=hubble+constant+crisis">DuckDuckGo</a></li>
</ul>
<p>To understand why, imagine you have a laser, and you shoot a laser beam into space.</p>

<p>Now imagine the laser beam passes a series of targets you've placed in space, each 200 million light years apart.</p>

<p>In a simple universe, the laser beam will reach the first target in 200 million years, the second target in 400 million light years, and so on.</p>

<div id="staticModel"></div>

<p>But we don't live in such a simple universe. We observe cosmological redshifts, which are interpreted as galaxies moving away from us in an expanding universe.</p>

<p>The question is then, how fast is the universe expanding?</p>

<p>Based on observations, a target that begins 13.8 billion light years away would be 46.6 billion light years away by the time the laser beam caught up with it. 
    Also, a target that started 5.5 billion light years away would be 11 billion light years away when the laser beam got to it.
    Those are the white points on the graph.</p>

<p>If Hubble's Law is v = H &times; D, where v is the apparent recessional velocity of the target, H is Hubble's Constant, and D is the comoving distance of the target, then what should H be?</p>

<p>If H is 0.00009 light years / year / million light years, the near-by data point can be reached.</p>

<div id="expandingFast"></div>

<p>If H is 0.000051 light years / year / million light years, the far data point can be reached.</p>

<div id="expandingSlow"></div>

<p>There isn't a single value for H that can be used in this model to reach both data points.</p>

<p>The problem isn't really Hubble's Constant. The problem is the interpretation of redshift and the version of Hubble's Law being used.</p>

<p>Edwin Hubble said that it was convenient for the redshift to be interpreted as a Doppler-like effect, leading to the expanding universe theory. 
    He said the redshifts might also be interpreted as how nature actually works: 
    there isn't another phenomenon causing the redshifts; the redshifts are a new phenomenon in themselves. 
    However, he noted, if there are existing ways to explain the redshift, adding new principles of nature should be avoided.</p>

<blockquote>When first observed the red-shifts were immediately attributed to radial motion away from the observer, to recession of the nebulae. 
    This interpretation still remains the only permissible explanation that is known. 
    It is true that other ways are known by which red-shifts might be produced, but in each case they would be accompanied by other phenomena which would 
    be conspicuous and, actually, are not found. 
    We may state with some confidence that <b>red-shifts are the familiar velocity-shifts, or else they represent some unrecognized principle of nature.</b>
    We cannot assume that our knowledge of physical principles is yet complete; nevertheless, we should not replace a known, 
    familiar principle by an ad hoc explanation <b>unless we are forced to that step by actual observations.</b>

    <br>
    <br>
    E. Hubble, <a href="https://ned.ipac.caltech.edu/level5/Sept04/Hubble/paper.pdf">The Observational Approach to Cosmology</a>, pg. 22, 1937 (emphasis added)
</blockquote>
    

<p>But the path of the familiar principles has led us to propose new principles anyways: accelerating expansion, dark energy, the inflation period, the multiverse. 
    We are clearly past the point of being forced to create new principles of physics.</p>

<p>Therefore, consider a literal interpretation of the law of redshifts:</p>

<blockquote>the law of red-shfts - the observed fact that light from a distant galaxy loses energy proportionally to the distance of the galaxy. 
    <br>
    <br>
    E. Hubble, <a href="https://ned.ipac.caltech.edu/level5/Sept04/Hubble/paper.pdf">The Observational Approach to Cosmology</a>, pg. 18, 1937
</blockquote>

<p>I've devised two hypotheses based on a literal interpretation of the redshifts to test.</p>

<p><b>Hypothesis 1: the speed of light = c - H &times; D</b></p>

<div id="redshift1"></div>

<p><b>Hypothesis 2: the speed of light = c / (1 + H &times; D)</b></p>

<div id="redshift2"></div>

<p>Note that Hypothesis 2 hits both data points.</p>

<p>In these models, the laser beam's speed diminishes as its distance from its source increases. The speed of a wave is its frequency &times; wavelength. 
    And the energy of a photon is its frequency &times; Planck's constant. We observe redshifts, which are a drop in frequency and energy. 
    Taken literally, that would also drop the laser beam's speed.</p>

<p>From this data and the models considered, Hypothesis 2 appears to be the real Hubble's Law. In such a universe, space is not expanding, there is no dark energy, 
    there is no age or size of the universe, and Hubble's Constant is a consistent 0.00035 Mly<sup>-1</sup>. </p>

<p>Hubble's Law should be:</p>

<blockquote>the speed of light = c / (1 + H &times; D)</blockquote>

<p>Note that H is independent of the units of c. A unit of inverse length for H means the denominator (1 + H &times; D) is unitless.</p>

<p>
    This conclusion raises questions that must be addressed that include:
    <ul>
        <li>Isn't the expansion of the universe a fact?</li>
        <li>Doesn't the Cosmic Microwave Background confirm an expanding universe?</li>
        <li>Doesn't this conflict with special relativity?</li>
        <li>Shouldn't we be able to measure a drop in a photon's speed?</li>
        <li>Doesn't this violate the Conservation of Energy?</li>
        <li>Isn't this the discredited Tired Light Theory?</li>
        <li>... more to come as questions come in</li>
    </ul>
    These are addressed below.
</p>

<hr>

<h4>Isn't the expansion of the universe a fact?</h4>

<p>Not exactly. The <i>redshifts</i> are an observed fact. The redshifts may be interpreted as motion, which leads to the expansion of the universe as a 
    hypothetical consequence. If every galaxy is moving away from our galaxy, that would put our galaxy in some special spot in the universe. 
    But if every galaxy is moving away from every galaxy, we would be in a normal galaxy in a universe that expands. </p>

<p>The theoretical expansion of the universe has hypothetical consequences of its own: a small, young universe dominated by dark energy, dark matter.</p>

<p>Edwin Hubble never accepted the expanding theory as a fact. He wrote:</p>

<blockquote>
    The familiar interpretation of red-shifts as velocity-shifts very seriously restricts not only the time scale, the age of the universe, 
    but the spatial dimensions as well. On the other hand, the alternative possible interpretation, 
    that red-shifts are not velocity-shifts, avoids both difficulties, and presents <b>the observable region as an 
    insignificant sample of a universe that extends indefinitely in space and in time</b>. 

    <br>
    <br>
    E. Hubble, <a href="https://ned.ipac.caltech.edu/level5/Sept04/Hubble/paper.pdf">The Observational Approach to Cosmology</a>, pg. 47, 1937 (emphasis added)
</blockquote>

<p>Much has changed since his day though. From the 30's to the 60's the expanding models were very simple. A point that expands.</p>

<p class="pimg"><img src="img/expansion_classic.jpg"></p>

<p>But in the 70's problems began to emerge.</p>

<ul>
    <li><a href="https://en.wikipedia.org/wiki/Horizon_problem">Horizon Problem</a></li>
    <li><a href="https://en.wikipedia.org/wiki/Flatness_problem">Flatness Problem</a></li>
    <li><a href="https://en.wikipedia.org/wiki/Big_Bang#Magnetic_monopoles">Magnetic Monopole Problem</a></li>
</ul>

<p>These problems lead to the theory of <a href="https://en.wikipedia.org/wiki/Inflation_(cosmology)">inflation.</a> 
    The universe blows up super fast in the first nanosecond after the big bang, then chills out. Then in 1998, it was discovered that the expansion of the universe is 
    <a href="https://en.wikipedia.org/wiki/Accelerating_expansion_of_the_universe">accelerating.</a></p>

<p>Today, the expanding theory of the universe looks like this:</p>

<p class="pimg"><img width="700px" src="img/cosmicinflation.jpg"></p>

<p>If the benefit of the expanding universe theory is, as Hubble wrote, that interpreting redshifts as motion doesn't require any new physics, 
    then the expanding theory gave away that benefit decades ago. </p>

<p>To make the problem worse, as we peer into the "early universe", we don't see only young galaxies. We see mature systems like the ones around us.</p>

<ul>
    <li><a href="https://skyandtelescope.org/astronomy-news/dead-ringer-milky-way-found-early-universe/">"Dead Ringer" for the Milky Way Found in Early Universe</a></li>
    <li><a href="https://www.space.com/how-can-a-star-be-older-than-the-universe.html"> How Can a Star Be Older Than the Universe?</a></li>
    <li><a href="https://www.sciencedaily.com/releases/2015/03/150302122925.htm"> Old-looking galaxy in a young universe: Astronomers find dust in the early universe</a></li>
    <li><a href="https://www.newscientist.com/article/dn26856-ancient-planets-are-almost-as-old-as-the-universe/?ignored=irrelevant#.VMlP1PlVK1E"> Ancient planets are almost as old as the universe</a></li>
    <li>More <a href="https://old.reddit.com/r/BigBangSkeptics">here.</a>
</ul>

<p>For these reasons and others, the widely accepted expansion theory is facing increasing criticism. Here's a sampling.</p>

<ul>
    <li>1995: <a href="https://www.nature.com/articles/377099a0">Nature: Big Bang not yet dead but in decline</a></li>
    <li>2004: <a href="http://cosmology.info/media/open-letter-on-cosmology.html">Open Letter on Cosmology / Cosmology Statement</a></li>
    <li>2019: <a href="https://blogs.scientificamerican.com/observations/cosmology-has-some-big-problems/">Cosmology Has Some Big Problems</a></li>
    <li>More <a href="http://cosmology.info/resources/index.html">here.</a></li>
</ul>

<p>In any case, the <i>redshifts</i> of distant galaxies are observed facts. The motion of those galaxies and expansion of space are theoretical interpretations of the facts.</p>

<hr>

<h4>Doesn't the Cosmic Microwave Background confirm an expanding universe?</h4>

<p>The expanding universe theory predicts we observe the same background temperature in all directions.</p>

<p>This prediction seemed to hold until 2003 when anomalies appeared, which were confirmed in 2013:</p>

<p class="pimg"><img src="img/cmb.jpg"></p>
<blockquote>
    Two Cosmic Microwave Background anomalous features hinted at by Planck's predecessor, NASA's Wilkinson Microwave Anisotropy Probe (WMAP), 
    are confirmed in the new high precision data from Planck.  One is an asymmetry in the average temperatures on opposite hemispheres of the 
    sky (indicated by the curved line), with slightly higher average temperatures in the southern ecliptic hemisphere and slightly lower 
    average temperatures in the northern ecliptic hemisphere. <b>This runs counter to the prediction made by the standard model that the Universe 
    should be broadly similar in any direction we look.</b> There is also a cold spot that extends over a patch of sky that is much larger 
    than expected (circled). In this image the anomalous regions have been enhanced with red and blue shading to make them more clearly visible.

    <br>
    <br>
    <a href="https://sci.esa.int/web/planck/-/51559-hemispheric-asymmetry-and-cold-spot-in-the-cosmic-microwave-background">
        https://sci.esa.int/web/planck/-/51559-hemispheric-asymmetry-and-cold-spot-in-the-cosmic-microwave-background</a>
</blockquote>

<p>This raises the question of where the <a href="https://en.wikipedia.org/wiki/CMB_cold_spot">CMB Cold Spot</a> might appear to other observers.</p>

<p>For instance, imagine observers at the north and south poles of our observable universe:</p>

<p class="pimg"><img src="img/cmbobservers.png"></p>

<p>We see a cold spot to the south. Does the south observer see a cold spot to their south? Does the north observer see the same CMB anomalies as we do?</p>

<p>This is a question the expanding universe theory doesn't have a clear answer for.</p>

<p>However, if the observable region is, as Hubble puts it, "an insignificant sample of a universe that extends indefinitely in space and in time",
    then there are no anomalies or questions. The cold spot is to <i>our</i> south, but to the southern observer the cold spot is in their vicinity. </p>

<p>One thing to keep in mind is that before the expanding theory even existed, Arthur Eddington 
    <a href="https://en.wikipedia.org/wiki/Cosmic_microwave_background#Timeline_of_prediction,_discovery_and_interpretation">
        calculated the temperature of starlight in our galaxy to be 3.18 Kelvin</a>. As such, the CMB may just be photons limping in 
        from galaxies 14 billion light years away, right before the temperature of space takes over our measurements. </p>
<hr>

<h4>Doesn't this conflict with special relativity?</h4>

<p>Yes, when light has traveled for millions of years, its speed will be less than c.</p>

<p>But our experiments and measurements don't last millions of years. In our experiments, H &times; D is so small, it can be considered zero.</p>

<p>So if:</p>

<pre>
    v_light = c / (1 + H &times; D)
    
    and:
    
    H &times; D = 0
    
    then:
    
    v_light = c / (1 + 0)
    
    v_light = c
</pre>

<p>In which case there shouldn't be any conflict with special relativity in the domain where the redshifts don't appear.</p>

<hr>

<h4>Shouldn't we be able to measure a drop in a photon's speed?</h4>

<p>The task would be to come up with a clever way to measure the speed of ancient light without disturbing the photon.</p>

<p>Say that light travels for hundreds of millions of years, and slows to below c, and then hits your telescope's lens.</p>

<p>At the quantum level, the photon will have been <a href="http://hyperphysics.phy-astr.gsu.edu/hbase/mod5.html">absorbed by atoms</a> in the lens. 
    Then a new photon, or maybe the old one, is emitted and focused to your telescope's eyepiece.</p>

<p>The photon may have traveled great distances from its source before it encountered your telescope, 
    but the light inside the telescope will be very close to its source: the lens that focused it. 
    The D of the photons in the telescope will not be millions of light years, but rather a few dozen centimeters.</p>

<p>Thus, any light that we interact with will presumably be moving at c / (1 + H &times; 0), or just c.</p>

<p>If there was a way to measure the speed of ancient light without interacting with it, that would make a good test of the hypothesis. </p>

<hr>

<h4>Doesn't this violate the Conservation of Energy?</h4>

<p>In the specific model demonstrated here, yes, energy is lost. 
    It could be that the energy deducted from the photon is deposited in space as it travels. </p>

<p>But I will let the esteemed <a href="https://en.wikipedia.org/wiki/Sean_M._Carroll">Sean Carroll</a> do the talking on this one.</p>

<blockquote>
    The thing about photons is that they redshift, losing energy as space expands. 
    If we keep track of a certain fixed number of photons, the number stays constant while the energy per photon decreases, 
    so the total energy decreases. A decrease in energy is just as much a “violation of energy conservation” as an increase in energy, 
    but it doesn’t seem to bother people as much. At the end of the day it doesn’t matter how bothersome it is, of course — it’s a 
    crystal-clear prediction of general relativity.

    <br>
    <br>
    <a href="https://www.preposterousuniverse.com/blog/2010/02/22/energy-is-not-conserved/">https://www.preposterousuniverse.com/blog/2010/02/22/energy-is-not-conserved/</a>
</blockquote>

<p>In an expanding universe, photons redshift and energy is lost.</p>

<p>Under the literal interpretation of redshifts, however, energy is lost or it might be deposited throughout space. 
    The photon could simply decay into tiny particles left in its path after 14 billion years.</p>

<p>Either way, if lost energy is an issue, then the expanding universe theory has the same issue.</p>

<hr>

<h4>Isn't this the discredited Tired Light Theory?</h4>

<p>In 1929, just after Hubble published the redshift-distance relation, Fritz Zwicky proposed that a type of gravitational drag was causing the redshift, 
    not an expanding universe. </p>

<p>However, such an effect would lead to a blurring of the light, which is not observed. Referring to an earlier quote, as Hubble said in 1937:</p>

<blockquote>
    It is true that other ways are known by which red-shifts might be produced, but in each case they would be accompanied by other phenomena which would 
    be conspicuous and, actually, are not found.
    <br>
    <br>
    E. Hubble, <a href="https://ned.ipac.caltech.edu/level5/Sept04/Hubble/paper.pdf">The Observational Approach to Cosmology</a>, pg. 22, 1937 
</blockquote>

<p>In Zwicky's Tired Light model, light loses energy but still travels at c. 
    This is represented by the red dots in the graph: a static universe with a universally constant speed of light. 
    This model does not hit either of the two data points aimed for.</p>

<p>The hypotheses presented here, represented by the green and magenta dots in the graph, are mathematically distinct from Zwicky's Tired Light. 
    The magenta line does connect the desired data points, which no other interpretation can claim.</p>

<p>So this is not Zwicky's Tired Light Theory. This is an even more literal interpretation of redshift and a novel mathematical model.</p>

<hr>

<h4>Conclusion</h4>

<p>Since 1929, cosmological redshifts have been a known, observed fact.</p>

<p>We could assume the redshifts indicate motion, in which case the universe is expanding, there are age and size limits to the universe, 
    it experienced hyper-expansion in the first nanosecond, is currently accelerating, and is dominated by dark matter and dark energy.
</p>

<p>Or we could assume the redshifts are a new feature of the universe we could only notice with big telescopes, and that's it. </p>

<p>With several hypotheses in hand, how to test them becomes the next question.</p>

<p>If the universe were expanding, in millions of years distant galaxies will be more distant than they are now, and the CMB will have a lower temperature.</p>

<p>In an indefinite universe, those distant galaxies will still be redshifted millions of years from now, but they will be in about the same place. 
    And the CMB will be the same temperature. </p>

<p>If we had millions of years to wait around, that would be a nice test to do.</p>

<p>In the meantime, I'm sure we'll think of others.</p>

<p>In conclusion, I would like to quote Hubble one last time. Here is his conclusion to <u>The Observational Approach to Cosmology</u>, pg. 52, 1937:</p>

<blockquote>We seem to face, as once before in the days of Copernicus, a choice between a small, finite universe, 
    and a universe indefinitely large plus a new principle of nature. </blockquote>

<hr>

<p><i>Mike Helland
<br>    
12 Nov 2020</i></p>

<p>Questions, comments, concerns?</p>
<ul>
    <li>Create a <a href="https://github.com/mikehelland/hubbles-law/issues">GitHub Issue</a></li>
    <li>Or <a href="mailto:mike@mikehelland.com">mike@mikehelland.com</a></li>
</ul>

<p>The source code for the models on this page are <a href="https://github.com/mikehelland/hubbles-law/blob/master/index.htm">here on GitHub</a>. Check out <a href="test.htm">the Testing Page</a> to try your own hypotheses and values</p>

<hr>

<h4>Change Log:</h4>

<ul>
    <li><i>16 Nov 2020</i> - Added conclusion, and bonus newspaper article. </li>
    <li><i>16 Nov 2020</i> - Added CMB question and answer. </li>
    <li><i>14 Nov 2020</i> - Added "Isn't expansion a fact?" question and answer. </li>
    <li><i>14 Nov 2020</i> - Fixed (1 - H &times; D) to (1 + H &times; D). Fixed units. </li>
    <li><i>12 Nov 2020</i> - Original. </li>
</ul>

<hr>

<p>Newspaper article announcing Edwin Hubble has refuted the expanding universe theory, Dec. 30, 1941:</p>

<img src="img/paper1941.png">

</div>

<canvas id="graph" height="600" width="600"></canvas>

<script>

    var graph = document.getElementById("graph")
    var ctxG = graph.getContext("2d")
    var models = []
    
    
    // the models advance by 1 million years each step
    // the units for distance are in Mly (million light years)

    // the speed of light is 1 million lightyears per 1 million years
    // Hubble's Constant is in units of Mly^-1 

    var c = 1

    var zoom = 0.056
    var zoomG = zoom * 0.65
    var zoomGY = zoom * 0.18
    var offset = 20
    
    function drawGraph() {
        
        ctxG.fillStyle = "black"
        ctxG.fillRect(0, 0, graph.width, graph.height)

        ctxG.strokeStyle = "white" 
        ctxG.strokeRect(offset, -10, graph.width, graph.height + 10 - offset)
        
        for (var m = 0; m < models.length; m++) {
            ctxG.fillStyle = models[m].color
            for (var i = 0; i < models[m].targets.length; i++) {
                if (models[m].targets[i].hit) {
                    //ctxG.fillRect(offset + models[m].targets[i].start * zoomG, -offset + graph.height - models[m].targets[i].hit * zoomGY, 5, 5)
                    ctxG.beginPath()
                    ctxG.arc(offset + models[m].targets[i].start * zoomG, -offset + graph.height - models[m].targets[i].hit * zoomGY, 3, 0, Math.PI * 2)
                    ctxG.fill()
                }
            }
            
        }

        ctxG.fillStyle = "white"
        ctxG.fillText("time to target (billion years)", offset + 5, offset)
        ctxG.fillText("starting distance to target (billion light years)", graph.width - 240, graph.height - 30)
        
        ctxG.beginPath()
        ctxG.arc(offset + 5500 * zoomG, graph.height - 11000 * zoomGY - offset, 6, 0, Math.PI * 2)
        ctxG.fill()
        ctxG.beginPath()
        ctxG.arc(offset + 13800 * zoomG, graph.height - 46660 * zoomGY - offset, 6, 0, Math.PI * 2)
        ctxG.fill()

        for (var i = 0; i < 80; i+=5) {
            ctxG.fillText(i, 4, -offset + graph.height - i * 1000 * zoomGY + 4)    
        }

        for (i = 0; i < 16; i+=2) {
            ctxG.fillText(i, offset + i * 1000 * zoomG, graph.height - 5)    
        }
    }

    function setupModel(model) {
        
        var playButton = document.createElement("button")
        playButton.innerHTML = "Click HERE to run"
        playButton.onclick = () => runModel(model)

        model.canvas = document.createElement("canvas")

        model.div.appendChild(playButton)
        model.div.appendChild(model.canvas)

        model.ctx = model.canvas.getContext("2d")
        model.nextTarget = 0

        model.canvas.width = 800
        model.canvas.height = 60
        
        // make a target every 200 million light years until 20 billion
        model.targets = []
        for (var i = 200; i <= 20000; i+=200) {
            model.targets.push({label: i/1000, start: i, x: i})
        }

        model.ctx.font = "8px sans-serif"
        model.ctx.lineWidth = 3
        draw(model.ctx, model)

        models.push(model)
    }

    function draw(ctx, exp) {

        ctx.fillStyle = "black"
        ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height)

        for (var i = 0; i < exp.targets.length; i++) {
            ctx.strokeStyle = exp.targets[i].hit ? exp.color : "#888888"
            ctx.beginPath()
            ctx.moveTo(exp.targets[i].x * zoom, 0)
            ctx.lineTo(exp.targets[i].x * zoom, ctx.canvas.height)
            //ctx.fillText(exp.targets[i].label, exp.targets[i].x * zoom + 2, 20)

            if (exp.targets[i].hit) {
                //ctx.fillText(Math.trunc(exp.targets[i].x / 10) / 100, exp.targets[i].x * zoom + 2, ctx.canvas.height - 10)
                //ctx.fillText(exp.targets[i].hit, exp.targets[i].x * zoom + 2, ctx.canvas.height - 10)
            }

            ctx.stroke()
        }

        ctx.fillStyle = "yellow"
        ctx.fillRect(exp.photon.x * zoom, ctx.canvas.height / 2, 5, 5)
    }

    function runModel(model) {
        model.photon.x = 0
        model.photon.dx = c
        model.nextTarget = 0
        model.targets.forEach(target => {
            target.x = target.start
            target.hit = 0
        })
    
        model.t = 0
        model.running = true

        var i
        var batch = 100
        var handle = setInterval(function () {
            for (i = 0; i < batch; i++) {
                if (model.targets[model.nextTarget] && model.t < 80000) {
                    model.t++
                    model.next()

                    if (model.targets[model.nextTarget].x <= model.photon.x) {
                        model.targets[model.nextTarget].hit = model.t
                        model.nextTarget++
                    }
                }
                else {
                    clearInterval(handle)
                    model.running = false
                }
            }
        }, 0)
    }

    setupModel({
        div: document.getElementById("staticModel"),
        name: "Static",
        color: "red", 
        photon: {x: 0},
        next: function () {
            this.photon.x += c
        }
    })
    setupModel({
        div: document.getElementById("expandingFast"),
        name: "Expanding Fast",
        color: "orange", 
        H: 0.00009,
        //H: 0.0000756,
        photon: {x: 0},
        next: function () {
            this.photon.x += c
            for (var i = 0; i < this.targets.length; i++) {
                this.targets[i].x += this.targets[i].start * this.H
            }
        }
    })
    setupModel({
        div: document.getElementById("expandingSlow"),
        name: "Expanding Slow",
        color: "blue", 
        H: 0.000051,
        //H: 0.00006888,
        photon: {x: 0},
        next: function () {
            this.photon.x += c
            for (var i = 0; i < this.targets.length; i++) {
                this.targets[i].x += this.targets[i].start * this.H
            }
        }
    })
    setupModel({
        div: document.getElementById("redshift1"),
        name: "Redshift by distance",
        color: "green", 
        H: 0.000072,
        photon: {x: 0, dx: c},
        next: function () {
            this.photon.x += c - this.H * this.photon.x
        }
    })
    setupModel({
        div: document.getElementById("redshift2"),
        name: "Redshift by distance 2",
        color: "magenta", 
        H: 0.00035,
        photon: {x: 0, dx: c},
        next: function () {
            this.photon.x += c / (1 + this.H * this.photon.x)
        }
    })


    setInterval(() => {
        for (var m = 0; m < models.length; m++) {
            if (models[m].running) {
                draw(models[m].ctx, models[m]) 
            }
        }

        drawGraph()
    }, 1000 / 60)

</script>




